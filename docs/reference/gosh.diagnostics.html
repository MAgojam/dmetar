<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function uses three unsupervised learning learning algorithms
(k-means, DBSCAN and Gaussian Mixture Models) to identify studies
contributing to the heterogeneity-effect size patterns found in GOSH (graphic
display of study heterogeneity) plots."><title>Identify studies contributing to heterogeneity patterns found in GOSH plots — gosh.diagnostics • dmetar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.6/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Identify studies contributing to heterogeneity patterns found in GOSH plots — gosh.diagnostics"><meta property="og:description" content="This function uses three unsupervised learning learning algorithms
(k-means, DBSCAN and Gaussian Mixture Models) to identify studies
contributing to the heterogeneity-effect size patterns found in GOSH (graphic
display of study heterogeneity) plots."><meta property="og:image" content="http://dmetar.protectlab.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="../costum.css"><link rel="stylesheet" href="costum.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dmetar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/dmetar.html">Get Started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Documentation</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/">Book</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://protectlab.org/en">Protect Lab</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/MathiasHarrer">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify studies contributing to heterogeneity patterns found in GOSH plots</h1>
      
      <div class="d-none name"><code>gosh.diagnostics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses three unsupervised learning learning algorithms
(<em>k</em>-means, DBSCAN and Gaussian Mixture Models) to identify studies
contributing to the heterogeneity-effect size patterns found in GOSH (graphic
display of study heterogeneity) plots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gosh.diagnostics</span><span class="op">(</span><span class="va">data</span>, km <span class="op">=</span> <span class="cn">TRUE</span>, db <span class="op">=</span> <span class="cn">TRUE</span>, gmm <span class="op">=</span> <span class="cn">TRUE</span>,
                 km.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="fl">3</span>,
                                  iter.max <span class="op">=</span> <span class="fl">10</span>, nstart <span class="op">=</span> <span class="fl">1</span>,
                                  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hartigan-Wong"</span>,
                                  <span class="st">"Lloyd"</span>, <span class="st">"Forgy"</span>,<span class="st">"MacQueen"</span><span class="op">)</span>,
                                  trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
                 db.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eps <span class="op">=</span> <span class="fl">0.15</span>, MinPts <span class="op">=</span> <span class="fl">5</span>,
                                  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hybrid"</span>, <span class="st">"raw"</span>, <span class="st">"dist"</span><span class="op">)</span><span class="op">)</span>,
                 gmm.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>G <span class="op">=</span> <span class="cn">NULL</span>, modelNames <span class="op">=</span> <span class="cn">NULL</span>,
                                   prior <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu">emControl</span><span class="op">(</span><span class="op">)</span>,
                                   initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hcPairs <span class="op">=</span> <span class="cn">NULL</span>,
                                   subset <span class="op">=</span> <span class="cn">NULL</span>,
                                   noise <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,
                                   Vinv <span class="op">=</span> <span class="cn">NULL</span>,
                                   warn <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"warn"</span><span class="op">)</span>,
                                   x <span class="op">=</span> <span class="cn">NULL</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
                 seed <span class="op">=</span> <span class="fl">123</span>,
                 verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>An object of class <code>gosh.rma</code> created through the
<code><a href="https://wviechtb.github.io/metafor/reference/gosh.html" class="external-link">gosh</a></code> function.</p></dd>
<dt>km</dt>
<dd><p>Logical. Should the <em>k</em>-Means algorithm be used to identify
patterns in the GOSH plot matrix? <code>TRUE</code> by default.</p></dd>
<dt>db</dt>
<dd><p>Logical. Should the DBSCAN algorithm be used to identify patterns
in the GOSH plot matrix? <code>TRUE</code> by default.</p></dd>
<dt>gmm</dt>
<dd><p>Logical. Should a bivariate Gaussian Mixture Model be used to
identify patterns in the GOSH plot matrix? <code>TRUE</code> by default.</p></dd>
<dt>km.params</dt>
<dd><p>A list containing the parameters for the <em>k</em>-Means algorithm
as implemented in <code>kmeans</code>. Run <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">?kmeans</a></code> for further details.</p></dd>
<dt>db.params</dt>
<dd><p>A list containing the parameters for the DBSCAN algorithm
as implemented in <code><a href="https://rdrr.io/pkg/fpc/man/dbscan.html" class="external-link">dbscan</a></code>. Run <code><a href="https://rdrr.io/pkg/fpc/man/dbscan.html" class="external-link">?fpc::dbscan</a></code> for further details.</p></dd>
<dt>gmm.params</dt>
<dd><p>A list containing the parameters for the Gaussian Mixture Models
as implemented in <code><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html" class="external-link">mclustBIC</a></code>. Run <code><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html" class="external-link">?mclust::mclustBIC</a></code> for further details.</p></dd>
<dt>seed</dt>
<dd><p>Seed used for reproducibility. Default seed is <code>123</code>.</p></dd>
<dt>verbose</dt>
<dd><p>Logical. Should a progress bar be printed in the console during clustering?</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>GOSH Plots</strong></p>
<p>GOSH (<em>graphic display of study
  heterogeneity</em>) plots were proposed by Olkin, Dahabreh and Trikalinos
  (2012) as a diagnostic plot to assess effect size heterogeneity. GOSH plots
  facilitate the detection of both (i) outliers and (ii) distinct homogeneous
  subgroups within the modeled data.</p>
<p>Data for the plots is generated by fitting a random-effects-model with the
  same specifications as in the meta-analysis to all \(\mathcal{P}(k),
  \emptyset \notin \mathcal{P}(k), \forall 2^{k-1} \leq 10^6\) possible
  subsets of studies in an analysis. For \(|\mathcal{P}(k)| &gt; 10^6\), 1
  million subsets are randomly sampled and used for model fitting when using
  the <code><a href="https://wviechtb.github.io/metafor/reference/gosh.html" class="external-link">gosh</a></code> function.</p>

<p><strong>GOSH Plot Diagnostics</strong></p>
<p>Although GOSH plots allow to detect heterogeneity patterns and distinct
  subgroups within the data, interpretation which studies contribute to a
  certain subgroup or pattern is often difficult or computationally
  intensive. To facilitate the detection of studies responsible for specific
  patterns within the GOSH plots, this function randomly samples \(10^4\)
  data points from the GOSH Plot data (to speed up computation). Of the data
  points, only the \(z\)-transformed \(I^2\) and effect size value is
  used (as other heterogeneity metrics produced for the GOSH plot data using
  the <code><a href="https://wviechtb.github.io/metafor/reference/gosh.html" class="external-link">gosh</a></code> function are linear combinations of
  \(I^2\)). To this data, three clustering algorithms are applied.</p><ul><li><p>The first algorithm is <em>k</em>-Means clustering using the
  algorithm by Hartigan &amp; Wong (1979) and \(m_k = 3\) cluster centers by
  default. The functions uses the <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code> implementation
  to perform <em>k</em>-Means clustering.</p></li>
<li><p>As <em>k</em>-Means does not
  perform well in the presence of distinct arbitrary subclusters and noise,
  the function also applies <strong>DBSCAN</strong> (<em>density reachability and
  connectivity clustering</em>; Schubert et al., 2017). The hyperparameters
  \(\epsilon\) and \(MinPts\) can be tuned for each analysis to maintain
  a reasonable amount of granularity while not producing too many
  subclusters. The function uses the <code><a href="https://rdrr.io/pkg/fpc/man/dbscan.html" class="external-link">dbscan</a></code> implementation
  to perform the DBSCAN clustering.</p></li>
<li><p>Lastly, as a clustering approach
  using a probabilistic model, Gaussian Mixture Models (GMM; Fraley &amp; Raftery, 2002)
  are integrated in the function using an internal call to the
  <code><a href="https://mclust-org.github.io/mclust/reference/mclustBIC.html" class="external-link">mclustBIC</a></code> implementation. Clustering hyperparameters can
  be tuned by providing a list of parameters of the <code>mclustBIC</code>
  function in the <code>mclust</code> package.</p></li>
</ul><p>To assess which studies predominantly contribute to a detected cluster,
  the function calculates the cluster imbalance of a specific study using the
  difference between (i) the expected share of subsets containing a specific
  study if the cluster makeup was purely random (viz., representative for the
  full sample), and the (ii) actual share of subsets containing a specific
  study within a cluster. Cook's distance for each study is then calculated
  based on a linear intercept model to determine the leverage of a specific
  study for each cluster makeup. Studies with a leverage value three times
  above the mean in any of the generated clusters (for all used clustering
  algorithms) are returned as potentially influential cases and the GOSH plot
  is redrawn highlighting these specific studies.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fraley C. and Raftery A. E. (2002) Model-based clustering, discriminant analysis
and density estimation, <em>Journal of the American Statistical Association</em>,
97/458, pp. 611-631.</p>
<p>Hartigan, J. A., &amp; Wong, M. A. (1979). Algorithm as 136: A K-Means Clustering Algorithm.
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics), 28</em> (1). 100–108.</p>
<p>Olkin, I., Dahabreh, I. J., Trikalinos, T. A. (2012). GOSH–a Graphical Display of Study Heterogeneity.
<em>Research Synthesis Methods 3</em>, (3). 214–23.</p>
<p>Schubert, E., Sander, J., Ester, M., Kriegel, H. P. &amp; Xu, X. (2017). DBSCAN Revisited, Revisited:
Why and How You Should (Still) Use DBSCAN. <em>ACM Transactions on Database Systems (TODS) 42</em>, (3). ACM: 19.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="InfluenceAnalysis.html">InfluenceAnalysis</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mathias Harrer &amp; David Daniel Ebert</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Example: load gosh data (created with metafor's 'gosh' function),</span></span>
<span class="r-in"><span class="co"># then use function</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"m.gosh"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gosh.diagnostics</span><span class="op">(</span><span class="va">m.gosh</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Look at results</span></span>
<span class="r-in"><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/print.rma.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot detected clusters</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, which <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot outliers</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, which <span class="op">=</span> <span class="st">"outlier"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mathias Harrer, Pim Cuijpers, Toshi Furukawa, David
Daniel Ebert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

